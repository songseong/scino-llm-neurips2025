import numpy as np

def get_mapped_index(var, dataset_name, to_index):
    if dataset_name == "ecoli70":
        return to_index(ecoli70_name_map[var])
    elif dataset_name == "magic-irri":
        return to_index(magic_irri_name_map[var])
    elif dataset_name == "magic-niab":
        return to_index(magic_niab_name_map[var])
    elif dataset_name == "arth150":
        return to_index(arth150_name_map[var])
    else:
        return to_index(var.lstrip("_"))

def get_mapped_name(index, dataset_name, to_name):
    raw_name = to_name(index)
    if dataset_name == "ecoli70":
        reverse_map = {v: k for k, v in ecoli70_name_map.items()}
        return reverse_map.get(raw_name, f"_UNKNOWN_{index}")
    
    elif dataset_name == "magic-irri":
        reverse_map = {v: k for k, v in magic_irri_name_map.items()}
        return reverse_map.get(raw_name, f"_UNKNOWN_{index}")
    
    elif dataset_name == "magic-niab":
        reverse_map = {v: k for k, v in magic_niab_name_map.items()}
        return reverse_map.get(raw_name, f"_UNKNOWN_{index}")
    
    elif dataset_name == "arth150":
        reverse_map = {v: k for k, v in arth150_name_map.items()}
        return reverse_map.get(raw_name, f"_UNKNOWN_{index}")

    else:
        return f"_{raw_name}"

ecoli70_name_map = {
    "_atpG": "atpG",
    "_b1191": "b1191",
    "_b1583": "b1583",
    "_b1963": "b1963",
    "_cchB": "cchB",
    "_cspA": "cspA",
    "_cspG": "cspG",
    "_dnaG": "dnaG",
    "_dnaJ": "dnaJ",
    "_dnaK": "dnaK",
    "_eutG": "eutG",
    "_fixC": "fixC",
    "_flgD": "flgD",
    "_folK": "folK",
    "_ftsJ": "ftsJ",
    "_gltA": "gltA",
    "_hupB": "hupB",
    "_ibpB": "ibpB",
    "_icdA": "icdA",
    "_lacA": "lacA",
    "_lacY": "lacY",
    "_lacZ": "lacZ",
    "_lpdA": "lpdA",
    "_mopB": "mopB",
    "_nmpC": "nmpC",
    "_nuoM": "nuoM",
    "_pspA": "pspA",
    "_pspB": "pspB",
    "_sucA": "sucA",
    "_sucD": "sucD",
    "_tnaA": "tnaA",
    "_yaeM": "yaeM",
    "_yceP": "yceP",
    "_ycgX": "ycgX",
    "_yecO": "yecO",
    "_yedE": "yedE",
    "_yfaD": "yfaD",
    "_yfiA": "yfiA",
    "_ygbD": "ygbD",
    "_ygcE": "ygcE",
    "_yhdM": "yhdM",
    "_yheI": "yheI",
    "_yjbO": "yjbO",
    "_atpD": "atpD",
    "_aceB": "aceB",
    "_asnA": "asnA"
}

magic_irri_name_map = {
    "_HT": "HT",
    "_FT": "FT",
    "_AMY": "AMY",
    "_GL": "GL",
    "_GW": "GW",
    "_GTEMP": "GTEMP",
    "_G4432": "G4432",
    "_G2670": "G2670",
    "_G4744": "G4744",
    "_G3092": "G3092",
    "_G3486": "G3486",
    "_G1533": "G1533",
    "_G2639": "G2639",
    "_G3823": "G3823",
    "_G1378": "G1378",
    "_G3105": "G3105",
    "_G3102": "G3102",
    "_G3098": "G3098",
    "_G317": "G317",
    "_G5167": "G5167",
    "_G1778": "G1778",
    "_G3872": "G3872",
    "_G4529": "G4529",
    "_G1440": "G1440",
    "_G5794": "G5794",
    "_G4668": "G4668",
    "_G2764": "G2764",
    "_G457": "G457",
    "_G3862": "G3862",
    "_G3964": "G3964",
    "_G4109": "G4109",
    "_G2089": "G2089",
    "_G3219": "G3219",
    "_G3209": "G3209",
    "_G3222": "G3222",
    "_G3212": "G3212",
    "_G4573": "G4573",
    "_G1311": "G1311",
    "_G2949": "G2949",
    "_G6003": "G6003",
    "_G6010": "G6010",
    "_G6123": "G6123",
    "_G2815": "G2815",
    "_G3049": "G3049",
    "_YLD": "YLD",
    "_CHALK": "CHALK",
    "_BROWN": "BROWN",
    "_SUB": "SUB",
    "_G1888": "G1888",
    "_G1958": "G1958",
    "_G4156": "G4156",
    "_G4382": "G4382",
    "_G3136": "G3136",
    "_G4145": "G4145",
    "_G3106": "G3106",
    "_G1266": "G1266",
    "_G3927": "G3927",
    "_G5997": "G5997",
    "_G4553": "G4553",
    "_G2179": "G2179",
    "_G5006": "G5006",
    "_G3992": "G3992",
    "_G678": "G678",
    "_G3925": "G3925"
}

magic_niab_name_map = {
    "_YR.GLASS": "YR.GLASS",
    "_HT": "HT",
    "_YR.FIELD": "YR.FIELD",
    "_MIL": "MIL",
    "_FT": "FT",
    "_G418": "G418",
    "_G311": "G311",
    "_G1217": "G1217",
    "_G800": "G800",
    "_G866": "G866",
    "_G795": "G795",
    "_G2570": "G2570",
    "_G260": "G260",
    "_G2920": "G2920",
    "_G832": "G832",
    "_G1896": "G1896",
    "_G2953": "G2953",
    "_G266": "G266",
    "_G847": "G847",
    "_G942": "G942",
    "_G200": "G200",
    "_G257": "G257",
    "_G2208": "G2208",
    "_G1373": "G1373",
    "_G599": "G599",
    "_G261": "G261",
    "_G383": "G383",
    "_G1853": "G1853",
    "_G1033": "G1033",
    "_G1945": "G1945",
    "_G1338": "G1338",
    "_G1276": "G1276",
    "_G1263": "G1263",
    "_G1789": "G1789",
    "_G2318": "G2318",
    "_G1294": "G1294",
    "_G1800": "G1800",
    "_YLD": "YLD",
    "_FUS": "FUS",
    "_G1750": "G1750",
    "_G524": "G524",
    "_G775": "G775",
    "_G2835": "G2835",
    "_G43": "G43"
}

arth150_name_map = {
    "_93": "93",
    "_197": "197",
    "_778": "778",
    "_360": "360",
    "_758": "758",
    "_4": "4",
    "_596": "596",
    "_539": "539",
    "_328": "328",
    "_519": "519",
    "_412": "412",
    "_100": "100",
    "_245": "245",
    "_296": "296",
    "_585": "585",
    "_342": "342",
    "_739": "739",
    "_161": "161",
    "_96": "96",
    "_363": "363",
    "_558": "558",
    "_269": "269",
    "_126": "126",
    "_783": "783",
    "_187": "187",
    "_679": "679",
    "_155": "155",
    "_547": "547",
    "_454": "454",
    "_640": "640",
    "_781": "781",
    "_600": "600",
    "_26": "26",
    "_20": "20",
    "_443": "443",
    "_573": "573",
    "_226": "226",
    "_101": "101",
    "_565": "565",
    "_570": "570",
    "_464": "464",
    "_256": "256",
    "_576": "576",
    "_135": "135",
    "_554": "554",
    "_378": "378",
    "_651": "651",
    "_460": "460",
    "_623": "623",
    "_598": "598",
    "_234": "234",
    "_219": "219",
    "_38": "38",
    "_181": "181",
    "_699": "699",
    "_86": "86",
    "_767": "767",
    "_61": "61",
    "_111": "111",
    "_496": "496",
    "_537": "537",
    "_480": "480",
    "_636": "636",
    "_622": "622",
    "_540": "540",
    "_81": "81",
    "_738": "738",
    "_211": "211",
    "_444": "444",
    "_299": "299",
    "_712": "712",
    "_63": "63",
    "_209": "209",
    "_8": "8",
    "_666": "666",
    "_377": "377",
    "_198": "198",
    "_248": "248",
    "_144": "144",
    "_368": "368",
    "_665": "665",
    "_686": "686",
    "_779": "779",
    "_798": "798",
    "_603": "603",
    "_108": "108",
    "_422": "422",
    "_736": "736",
    "_793": "793",
    "_627": "627",
    "_281": "281",
    "_661": "661",
    "_272": "272",
    "_560": "560",
    "_629": "629",
    "_452": "452",
    "_331": "331",
    "_47": "47",
    "_13": "13",
    "_714": "714",
    "_479": "479",
    "_289": "289",
    "_414": "414",
    "_726": "726",
    "_677": "677",
    "_786": "786",
    "_78": "78"
}